#!/bin/bash

resfile=res
# http $1 > $resfile

IFS=$'\r\n' choices=( $(rg -N --color never -o 'href="magnet.*title="([^"]*)"' -r '$1' $resfile) )
PS3="select a magnet link: "
select name in "${choices[@]}";
do
    index=($REPLY)
    break;
done

echo "$index" | grep -v "^\d$" > /dev/null && echo "input, $index, is not a single digit!" && exit 1
[ "$index" -gt "${#choices[@]}" ] && echo "choice is out of range!" && exit 1

# this get the magnet links themsvles, no color or line numbers
magnet=$(rg -N --color never -o 'href="(magnet[^"]*)"' -r '$1' "$resfile" | sed -n "${index}p")
echo $magnet


unset resfile
